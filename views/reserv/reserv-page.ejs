<%- include ("../partials/header.ejs") %>
Minhas Reservas</title>
<link rel="stylesheet" href="css2/reserv-page.css">
</head>
<% if(usuario.nivel_usuario == 1){ %>
    <%- include ("../partials/navbar4.ejs") %>
<% }else{ %>
    <%- include ("../partials/navbar3.ejs") %>
<% } %>
<body>
    <div class="tetudo">
        <div class="metade1">
            <div class="menu-perfil">

                <div class="nome-perfil">
                    <div class="img-container">
                        <img class="perfil-photo" src="/img/icons8-male-user-preto.png" alt="">
                    </div>
                    <div class="nomes">
                        <h5><%= nome %></h5>
                    </div>
                </div>
                
                <div class="menu">
                    <ul>
                        <li><a href="/perfil_page">Meu Perfil</a></li>
                        <li><a href="/vehicle_page">Meus Veículos</a></li>
                        <li>Minhas Reservas</li>
                        <li><a href="/accounts_page">Contas</a></li>
                    </ul>
                </div>
            </div>
        </div>


        <div class="metade2">
            <div class="container border-defaul">
                <div class="meu-perfil">
                    <div class="title-align">
                        <h2>Minhas reservas</h2>
                    </div>

                    <div class="reserv-list">
                        <!-- SIM é TUDO ISSO -->

                        <% reservas.forEach((reserva) => { %>
                            <div class="reserv">
                                <div class="day">
                                    <div class="yellow-bar"></div>
                                    <div class="special-day">
                                        <% 
                                            // Adiciona o fuso horário para garantir a exibição correta
                                            const dataReserva = new Date(reserva.data_reserva);
                                            dataReserva.setHours(dataReserva.getHours() + 3); // Ajuste para GMT-3
                        
                                            const diaSemana = dataReserva.toLocaleString('pt-BR', { weekday: 'short' });
                                            const diaMes = dataReserva.getDate();
                                        %>
                                        
                                        <p><%= diaSemana %></p> <!-- Dia da semana -->
                                        <h3><strong><%= diaMes %></strong></h3> <!-- Dia no mês -->
                                        <p><%= reserva.prev_chegada.slice(0, 5) %></p> <!-- Hora no formato HH:MM -->
                                    </div>
                                    <div class="line"></div>
                                </div>
                                <div class="reserv-content">
                                    <h3><strong>Vaga <%= reserva.vaga.numero %></strong></h3> <!-- Número da vaga -->
                                    <p>Veículo - <strong><%= reserva.veiculo.marca %> <%= reserva.veiculo.modelo %> <%= reserva.veiculo.cor %></strong></p> <!-- Detalhes do veículo -->
                                    <p>Placa - <strong><%= reserva.veiculo.placa %></strong></p> <!-- Placa do carro -->
                                </div>
                                <div class="cancel-button">
                                    <!-- Adiciona evento de confirmação ao clicar no link -->
                                    <a href="/cancel-reserv?id_reserva=<%= reserva.id_reserva %>" onclick="return confirmCancel()">Cancelar</a>
                                </div>
                            </div>
                        <% }) %>                        
                    </div>

                </div>
            </div>
        </div>
    </div>

    <div class="hide-div">
        <%- include ("../partials/navbar-mobile.ejs") %>

        <div class="title-align">
            <h2>Minhas reservas</h2>
        </div>

        <div class="reserv-list">
            <!-- SIM é TUDO ISSO -->

            <% reservas.forEach((reserva) => { %>
                <div class="reserv">
                    <div class="day">
                        <div class="yellow-bar"></div>
                        <div class="special-day">
                            <% 
                                // Adiciona o fuso horário para garantir a exibição correta
                                const dataReserva = new Date(reserva.data_reserva);
                                dataReserva.setHours(dataReserva.getHours() + 3); // Ajuste para GMT-3
            
                                const diaSemana = dataReserva.toLocaleString('pt-BR', { weekday: 'short' });
                                const diaMes = dataReserva.getDate();
                            %>
                            
                            <p><%= diaSemana %></p> <!-- Dia da semana -->
                            <h3><strong><%= diaMes %></strong></h3> <!-- Dia no mês -->
                            <p><%= reserva.prev_chegada.slice(0, 5) %></p> <!-- Hora no formato HH:MM -->
                        </div>
                        <div class="line"></div>
                    </div>
                    <div class="reserv-content">
                        <h3><strong>Vaga <%= reserva.vaga.numero %></strong></h3> <!-- Número da vaga -->
                        <p>Veículo - <strong><%= reserva.veiculo.marca %> <%= reserva.veiculo.modelo %> <%= reserva.veiculo.cor %></strong></p> <!-- Detalhes do veículo -->
                        <p>Placa - <strong><%= reserva.veiculo.placa %></strong></p> <!-- Placa do carro -->
                    </div>
                    <div class="cancel-button">
                        <!-- Adiciona evento de confirmação ao clicar no link -->
                        <a href="/cancel-reserv?id_reserva=<%= reserva.id_reserva %>" onclick="return confirmCancel()">Cancelar</a>
                    </div>
                </div>
            <% }) %>                        
        </div>
    </div>

</body>
<%- include ("../partials/footer.ejs") %>
<script>
    function confirmCancel() {
        return confirm("Tem certeza de que deseja cancelar esta reserva?");
    }
</script>